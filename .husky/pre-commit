printf "[husky] pre-commit\n"

npx --no lint-staged || exit 1

CHANGED="$(git diff --name-only --cached --diff-filter=ACMR)"

if [ -z "$CHANGED" ]; then
  printf "\nπ§ μ¤ν…μ΄μ§€λ μ½”λ“κ°€ μ—†μµλ‹λ‹¤. ν…μ¤νΈλ¥Ό μ¤ν‚µν•©λ‹λ‹¤.\n\n"
  exit 0
fi

printf "\nchanged files:\n%s\n" "$CHANGED"

if ! printf "%s" "$CHANGED" | grep -E '\.(ts|tsx|js|jsx|mjs|cjs)$' >/dev/null; then
  printf "\nπ§ ν…μ¤νΈ λ€μƒ μ½”λ“ λ³€κ²½μ΄ μ—†μµλ‹λ‹¤. ν…μ¤νΈλ¥Ό μ¤ν‚µν•©λ‹λ‹¤.\n\n"
  exit 0
fi

npm run test
